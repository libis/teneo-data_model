<?xml version="1.0" encoding="UTF-8"?>
<fdd:FDD id="fdd000438" titleName="OpenDocument Spreadsheet Document Format (ODS), Version 1.1,  ISO 26300:2006" shortName="ODF_spreadsheet_1_1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:fdd="http://www.loc.gov/preservation/digital/formats/schemas/fdd/v1" xsi:schemaLocation="http://www.loc.gov/preservation/digital/formats/schemas/fdd/v1 http://www.loc.gov/preservation/digital/formats/schemas/fdd/v1/fdd-v1-1.xsd">
	<fdd:properties>
		<fdd:gdfrGenreSelection>
			<fdd:gdfrGenreAndSubgenres>
				<fdd:gdfrGenre>spreadsheet</fdd:gdfrGenre>
				<fdd:gdfrSubgenres>
					<fdd:gdfrSubgenre>dataset</fdd:gdfrSubgenre>
				</fdd:gdfrSubgenres>
			</fdd:gdfrGenreAndSubgenres>
		</fdd:gdfrGenreSelection>
		<fdd:formatCategories>
			<fdd:category>file-format</fdd:category>
			<fdd:category>encoding</fdd:category>
		</fdd:formatCategories>
		<fdd:gdfrComposition>unitary</fdd:gdfrComposition>
		<fdd:gdfrForm>text</fdd:gdfrForm>
		<fdd:gdfrConstraint>structured</fdd:gdfrConstraint>
		<fdd:gdfrBasis>symbolic</fdd:gdfrBasis>
		<fdd:gdfrDomains>
			<fdd:gdfrDomain>
				<fdd:value>office/business</fdd:value>
			</fdd:gdfrDomain>
		</fdd:gdfrDomains>
		<fdd:updates>
			<fdd:date>2020-12-18</fdd:date>
		</fdd:updates>
		<fdd:draftStatus>Full</fdd:draftStatus>
	</fdd:properties>
	<fdd:identificationAndDescription>
		<fdd:fullName>OpenDocument Spreadsheet Document Format (ODS), Version 1.1.  Part of OASIS Open Document Format for Office Applications, Version 1.1 and the equivalent ISO 26300:2006 (including 2012 Amendment 1).</fdd:fullName>
		<fdd:description>
			<p>The OpenDocument Spreadsheet Document Format (ODS), Version 1.1 (given the short name <i>ODF_spreadsheet_1_1</i> here) is an XML-based format for editable spreadsheet documents.  It is one of several subtypes in the <fddLink id="fdd000247">ODF family</fddLink> for particular content categories.  The format, an international standard, is specified in the ODF 1.1 specification as published by OASIS.  The ISO/IEC 26300:2006 specification is equivalent when modified by its 2012 amendment.  The key difference between <i>ODF_spreadsheet_1_1</i> and <fddLink id="fdd000439">ODF_spreadsheet_1_2</fddLink> is that the later version incorporates the OpenFormula specification for formulas and functions, whereas <i>ODF_spreadsheet_1_1</i> allowed any syntax for strings representing formulas.  This shortcoming led to interoperability problems resolved in the later version.</p>
			<p>The primary ODF markup used for spreadsheets is specified in the <i>table:</i> namespace, with the <i>&lt;table:table&gt;</i> element as a container for each worksheet.  The same namespace and markup is used for tables in textual documents.</p>
			<p>The ODF specification covers two physical forms for ODF documents, a flat form as a single XML file and a package form based on the <fddLink id="fdd000354">ZIP_PK</fddLink> format.  See Notes in <fddLink id="fdd000247">ODF Family</fddLink> for more information about the flat XML-only variant of ODF files.  For a flat ODF spreadsheet file, usually given a file extension of .fods, the root <i>&lt;office:document&gt;</i> element has an <i>office:mimetype</i> attribute with one of
the values listed below as <a href="#sign">File signifiers</a>.  This description focuses on the more commonly used ZIP-based package format for ODF spreadsheet files, typically given the <i>.ods</i> file extension.  Files using the same markup specification and package but with an extension of <i>.ots</i> are for use as spreadsheet document templates.</p>
			<p>An ODF package can be recognized as a spreadsheet document in several ways.  Externally, there are file extensions for two ways in which ODF spreadsheet documents may be used, as noted above.  The primary internal indication is that the mandatory file named <i>mimetype</i> will contain one of the corresponding strings listed as <a href="#sign">File signifiers</a> below.  An additional way to recognize an ODF spreadsheet document is that  the <i>&lt;office:body&gt;</i> element, a child of the root <i>&lt;office:document-content&gt;</i> element in <i>content.xml</i> has the child element <i>&lt;office:spreadsheet&gt;</i>.</p>
			<p>The typical <i>content.xml</i> file for a minimal spreadsheet file with a single worksheet has the basic form:</p>
			<ul>
				<li>&lt;office:document-content&gt;</li>
				<li>&lt;office:automatic-styles&gt;  -- captures formatting styles created automatically in response to a direct user choice, such as a fill color for a cell, with references to fuller style specifications in the <i>styles.xml</i> file -- &lt;/office:automatic-styles&gt;</li>
				<li>&lt;office:body&gt;</li>
				<li>&lt;office:spreadsheet&gt;</li>
				<li>&lt;table:table&gt; -- contains a series of &lt;table:table-column&gt; elements to describe each column in the table.  The column specifications are followed by &lt;table:table-row&gt; elements consisting of &lt;table:table-cell&gt; entries. A cell that contains a string will contain a child &lt;text:p&gt; element.  A cell containing a number will also contain a &lt;text:p&gt; that shows the display form of the value. The actual value is stored in the &lt;table:table-cell&gt; element using two attributes: <i>office:value-type</i> and <i>office:value</i>.  Numeric value types for cells are <i>float</i>, <i>percentage</i>, and <i>currency</i>.  Separate types are used to indicate date and time values.  For discussion of cells containing formulas, see <a href="#notes">Notes</a> below -- &lt;/table:table&gt;</li>
				<li>&lt;/office:spreadsheet&gt;</li>
				<li>&lt;/office:body&gt;</li>
				<li>&lt;/office:document-content&gt;</li>
			</ul>
			<p>For details of the ZIP-based package for ODF_spreadsheet_1_1, see <fddLink id="fdd000424">ODF_package_1_1</fddLink>.  The typical files for a minimal spreadsheet document include:  <i>mimetype</i> (one-line file containing only the string &quot;application/vnd.oasis.opendocument.spreadsheet&quot;; 
<i>./META-INF/manifest.xml</i> (package manifest); <i>content.xml</i> (spreadsheet content); <i>styles.xml</i> (spreadsheet formatting).  The package specification, in clause 17 of the ODF 1.1 specification defines the form for the package manifest, and support for encryption, etc.</p>
		</fdd:description>
		<fdd:shortDescription>An XML-based, international standard format for a spreadsheet that is editable.  Usual file extension is .ods.   Documented with formats for other content categories in the OpenDocument Format (ODF) 1.1.  Standard developed by OASIS and also approved as ISO/IEC 26300:2006 with 2012 amendment.  Superseded by ODF 1.2.</fdd:shortDescription>
		<fdd:productionPhase>Can be used in any production phase.  Particularly used for creating documents (initial state) and for editing and review (middle-state). Used in final-state contexts where recalculation based on current data are required.</fdd:productionPhase>
		<fdd:relationships>
			<fdd:relationship>
				<fdd:typeOfRelationship>Subtype of</fdd:typeOfRelationship>
				<fdd:relatedTo>
					<fdd:id>fdd000247</fdd:id>
					<fdd:shortName>ODF_Family</fdd:shortName>
					<fdd:titleName>OpenDocument Format (ODF) Family, OASIS and ISO/IEC 26300</fdd:titleName>
				</fdd:relatedTo>
			</fdd:relationship>
			<fdd:relationship>
				<fdd:typeOfRelationship>Subtype of</fdd:typeOfRelationship>
				<fdd:relatedTo>
					<fdd:id>fdd000424</fdd:id>
					<fdd:shortName>ODF_package_1_1</fdd:shortName>
					<fdd:titleName>OpenDocument Package Format, ODF 1.1, ISO 26300:2006</fdd:titleName>
				</fdd:relatedTo>
			</fdd:relationship>
			<fdd:relationship>
				<fdd:typeOfRelationship>Contains</fdd:typeOfRelationship>
				<fdd:comment>META-INF/manifest.xml file, not described separately on this resource at this time. This manifest file is mandatory in all ODF packages.</fdd:comment>
			</fdd:relationship>
			<fdd:relationship>
				<fdd:typeOfRelationship>Has later version</fdd:typeOfRelationship>
				<fdd:relatedTo>
					<fdd:id>fdd000439</fdd:id>
					<fdd:shortName>ODF_spreadsheet_1_2</fdd:shortName>
					<fdd:titleName>OpenDocument Spreadsheet Document Format (ODS), Version 1.2, ISO 26300:2015</fdd:titleName>
				</fdd:relatedTo>
			</fdd:relationship>
			<fdd:relationship>
				<fdd:typeOfRelationship>Defined via</fdd:typeOfRelationship>
				<fdd:relatedTo>
					<fdd:id>fdd000263</fdd:id>
					<fdd:shortName>XML_1_0</fdd:shortName>
					<fdd:titleName>XML (Extensible Markup Language) 1.0</fdd:titleName>
				</fdd:relatedTo>
				<fdd:comment> A normative RELAX NG schema is part of the specification for ODF 1.1, which includes the specification for spreadsheet documents.</fdd:comment>
			</fdd:relationship>
		</fdd:relationships>
	</fdd:identificationAndDescription>
	<fdd:localUse>
		<fdd:experience>See <fddLink id="fdd000247">ODF_family</fddLink>.</fdd:experience>
		<fdd:preference>The Library of Congress <a href="https://www.loc.gov/preservation/resources/rfs/data.html">Recommended Formats Statement (RFS)</a> does not explicitly list ODF (ISO/IEC 26300) as an acceptable format for datasets. As described here, spreadsheets in the ODF 1.1. format have generated significant interoperability problems, considerably mitigated in ODF 1.2 with the incorporation of the OpenFormula specification.</fdd:preference>
	</fdd:localUse>
	<fdd:sustainabilityFactors>
		<fdd:disclosure>International open standard.  Developed and maintained by <a href="https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=office">OASIS Open Document Format for Office Applications (OpenDocument) TC</a> as part of the OpenDocument Format (ODF) 1.1 specification published by OASIS in 2007.  Also approved as part of the equivalent ISO/IEC 26300:2006 by ISO/IEC JTC1/SC34.</fdd:disclosure>
		<fdd:documentation>
			<p>Specifications from OASIS: <a href="https://docs.oasis-open.org/office/v1.1/">Open Document Format for Office Applications (OpenDocument) Version 1.1</a>.  Specification for ODF 1.1 spreadsheet documents are found primarily in chapter 8 of the specification.  The technical specification is part of a <a href="https://docs.oasis-open.org/office/v1.1/OS/OpenDocument-schema-v1.1.rng">normative RNG schema for primary component files for ODF documents</a>.</p>
			<p>An equivalent specification was adopted by ISO and published by means of <a href="https://standards.iso.org/ittf/PubliclyAvailableStandards/c043485_ISO_IEC_26300_2006(E).zip">ISO/IEC 26300:2006, Information technology -- Open Document Format for Office Applications (OpenDocument) v1.0</a> together with a 2012 amendment, <a href="https://standards.iso.org/ittf/PubliclyAvailableStandards/c059302_ISO_IEC_26300_2006_Amd_1_2012.zip">ISO/IEC 26300:2006, Information technology -- Open Document Format for Office Applications (OpenDocument) v1.0 -- Amendment 1: Open Document Format for Office Applications (OpenDocument) v1.1</a>. A number of technical corrigenda have been published.</p>
		</fdd:documentation>
		<fdd:adoption>
			<p>OpenOffice.org introduced support for ODF 1.0 in the beta version of OpenOffice 2.0 in 2005, according to <a href="https://www.openoffice.org/about_us/2.0beta_press_release.html">Press Release for OpenOffice 2.0 beta</a>. From Version 2.0 onward, OpenOffice.org used the standard ODF OpenDocument as its native format. Versions 2.0 through 2.3.0 defaulted to ODF 1.0; versions 2.3.1 through 2.4.3 defaulted to ODF 1.1; versions 3.0 onward defaulted to ODF 1.2.  The version of OpenOffice.org at the time of the 2010 split between OpenOffice and LibreOffice was 3.3.</p>
			<p>The adopters of ODF listed in the April 2009 <a href="https://www.iana.org/assignments/media-types/application/vnd.oasis.opendocument.spreadsheet">registration of MIME type for ODF spreadsheet documents</a> included: IBM (<a href="https://web.archive.org/web/20150310034354/http://www-03.ibm.com/software/products/en/lotusymp">Lotus Symphony</a>), KOffice (became <a href="https://calligra.org/">Calligra</a>),
<a href="https://www.neooffice.org/neojava/en/index.php">NeoOffice</a> (which started as a Mac-oriented fork from OpenOffice.org),
OpenOffice.org (predecessor to Apache OpenOffice and LibreOffice), StarOffice (predecessor of OpenOffice.org, code contributed to Apache OpenOffice),
and TextMaker (now part of <a href="https://www.softmaker.com/en/softmaker-office">SoftMaker</a>).</p>
			<p>The major applications supporting ODF in 2020 can read and write spreadsheet documents as defined in ODF 1.1, although the default format is usually ODF 1.2 (or 1.2 Extended).</p>
			<ul>
				<li>Apache OpenOffice offers users the ability to save documents as ODF 1.0/1.1.  </li>
				<li>LibreOffice also offers ODF 1.0/1.1 as a format for saving documents. <a href="https://wiki.documentfoundation.org/images/3/39/GS3502-SettingUpLibreOffice.pdf">Setting Up LibreOffice</a> suggests choosing this option to share documents with people using editing software that supports only the older format.</li>
				<li>Microsoft first introduced support for ODF_spreadsheet_1_1 with Service Pack 2 for Excel 2007.  Support is also provided in Excel 2010, 2013, and 2016.  Microsoft <a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offdi/7ffd4731-47eb-46c0-a934-ea154df676d0">lists ODF (both ODF 1.1 and ODF 1.2) as a &quot;persistence format&quot; for Excel</a>.  This indicates that use of ODF in Office does not involve conversion to and from <fddLink id="fdd000395">OOXML</fddLink>.  See <a href="#notes">Notes</a> and <a href="#useful">Useful references</a> below for information relating to how Microsoft supports ODF_spreadsheet _1_1, including the syntax for formulas, given that the ODF 1.1 specification does not mandate a particular syntax for formulas.</li>
			</ul>
		</fdd:adoption>
		<fdd:licensingAndPatents>No concerns.  See <fddLink id="fdd000247">ODF_Family</fddLink>.</fdd:licensingAndPatents>
		<fdd:transparency>
			<p>The structure and text of an ODS file are all represented in XML and hence viewable without special tools, although XML-aware tools that can show the element hierarchy make viewing and interpretation more convenient.  The most commonly used parts, elements, and attributes have recognizable names. Simple documents can be interpreted with very basic tools. However, interpreting the semantics of some elements and the correspondence of some elements and attributes to spreadsheet terminology or functionality will require not only understanding of the schema and the specification text, but familiarity with the associated terminology and functionality.</p>
		</fdd:transparency>
		<fdd:selfDocumentation>
			<p>ODF 1.1 support for metadata is through three mechanisms defined in clauses 2.2 (Document Metadata) and clause 3 (Metadata Elements) of the OASIS ODF 1.1 specification: predefined elements explicitly listed in the specification; user-defined metadata, using a specified XML structure for a triplet of name, data type, and value; and custom metadata, held in arbitrary elements within the &lt;office:meta&gt; element.  The ODF 1.1 specification requires implementers to preserve custom metadata.  Note that the use of arbitrary custom metadata was deprecated in ODF 1.2 and replaced by support for RDF-based metadata.</p>
			<p>Pre-defined metadata elements for the document as a whole, stored in an <i>&lt;office:meta&gt;</i> element  include:</p>
			<ul>
				<li>From the Dublin core namespace, using the <i>dc:</i> prefix: Title, Creator (of most recent modification), Description, Subject, Date (last modified), Language</li>
				<li>From the ODF specification, using the <i>meta:</i> prefix: Generator (creating software application), Keywords, Initial Creator, Creation Date and Time, Modification Date and Time, Print Date and Time, Document Template, Document Statistics (word count, page count, etc.),</li>
			</ul>
			<p>The pre-defined elements are all optional and repeatable.  However, applications are not required to update multiple occurrences in a specific way to reflect modifications to a document.</p>
			<p>Also supported in both ODF 1.1 and ODF 1.2 is an XML structure for user-defined metadata, based on triplets of name, data type, and value.</p>
		</fdd:selfDocumentation>
		<fdd:externalDependencies>
			<p>Depends on features used.  Spreadsheets may include links to externally stored data.  Macros can be included.</p>
		</fdd:externalDependencies>
		<fdd:techProtection>Encryption is supported for files within an ODF 1.1 package.  In addition, an ODF package file may be encrypted during interchange or as part of DRM controlling distribution.</fdd:techProtection>
	</fdd:sustainabilityFactors>
	<fdd:qualityAndFunctionalityFactors>
		<fdd:textQF>
			<fdd:normalText>
				<p>No specific set of factors for assessing quality and functionality of a spreadsheet format has been developed. This format description uses selected factors for assessing formats for text and datasets.</p>
				<p>Some spreadsheets have a printable or viewable report as a primary function.  Textual content in cells in ODF_spreadsheet_1_1 worksheets is conveniently extractable for quotation and for indexing.  Full support for Unicode.</p>
			</fdd:normalText>
			<fdd:structure>The semantic structure of formulas and their relationship to cells with values is fully represented.  Rectangular areas within a worksheet can be identified as tables, with labels for rows and columns.</fdd:structure>
			<fdd:layout>Excellent support for layout choices. Represents entire layout and formatting as intended by an author who used an application for which ODF_spreadsheet_1_1 is a native format.  Differences in detail can occur on display if the original fonts used are not available in the system used for viewing.  Charts based on data in the spreadsheet are considered separate objects, which can be positioned on a sheet.</fdd:layout>
			<fdd:mathDiag>
				<p>Equations or formulas can be represented visually in ODF-spreadsheet_1_1 using MathML.  The MathML object is a separate object, which can be positioned on a page like a chart.</p>
			</fdd:mathDiag>
			<fdd:beyondText>As a format designed for creating and editing a spreadsheet, ODF_spreadsheet_1_1 stores information associated with the process of creation and review of spreadsheets, such as comments.  Also supported are embedded media objects in binary formats, and links to external media objects, such as images, audio, or video.</fdd:beyondText>
		</fdd:textQF>
		<fdd:datasetQF>
			<fdd:normalDataset>
				<p>ODF_spreadsheet_1_1 does not support the range of data types as typical in database applications and programming languages, e.g., to distinguish integers from floating point numbers.  It uses a limited set of data types for values in cells. The only pure numeric type is <i>float</i>.  The ODF 1.1 specification provides no information on numeric precision, but most spreadsheet software has a practical limit of 15 decimal digits. This is insufficient for some forms of statistical analysis (see <a href="#useful">references</a> below).</p>
				<p>Cells with numbers that are intended as percentages or currency values have distinct types.  Types and syntax for dates and times are based on XML Schema types.  There is a single <i>string</i> type for text.  There is also a <i>boolean</i> type with permitted values <i>true</i> and <i>false</i>.</p>
			</fdd:normalDataset>
			<fdd:accessSoftware>
				<p>There is no API specifically aimed at the use of ODF_spreadsheet_1_1 to hold a dataset.  See <a href="#notes">Notes on Relationship to CSV</a> for discussion of widely used support for extracting data from a spreadsheet for use in statistical software.</p>
			</fdd:accessSoftware>
			<fdd:dataDocumentation>ODF packages have no specific support for rich discipline-specific metadata or codebooks in externally specified schemas.  ODF 1.1 allows for &quot;custom&quot; metadata in arbitrary format, but this feature was deprecated in ODF 1.2 and is therefore not recommended.  See Self-documentation in <a href="#sustainability">Sustainability Factors</a> above.</fdd:dataDocumentation>
			<fdd:beyondDataset>An ODF spreadsheet document can hold not only raw data, but also formulas that perform calculations on that data and present results as numbers or in graphical form.  It can also include: macros; visual mathematical representation of equations; and charts based on the spreadsheet data.</fdd:beyondDataset>
		</fdd:datasetQF>
	</fdd:qualityAndFunctionalityFactors>
	<fdd:fileTypeSignifiers>
		<fdd:signifiersGroup>
			<fdd:filenameExtension>
				<fdd:sigValues>
					<fdd:sigValue>ods</fdd:sigValue>
				</fdd:sigValues>
				<fdd:note>
					<i>.ods</i> is the extension used for a spreadsheet file.</fdd:note>
			</fdd:filenameExtension>
			<fdd:internetMediaType>
				<fdd:sigValues>
					<fdd:sigValue>application/vnd.oasis.opendocument.spreadsheet</fdd:sigValue>
				</fdd:sigValues>
			</fdd:internetMediaType>
			<fdd:magicNumbers>
				<fdd:sigValueNA>See note.</fdd:sigValueNA>
				<fdd:note>Magic numbers that apply to ODF document category subtypes incorporate the magic number for  <fddLink id="fdd000354">ZIP_PK</fddLink>,  the string <i>mimetype</i> at position 30, and the MIME subtype string value at position 38.</fdd:note>
			</fdd:magicNumbers>
			<fdd:other>
				<fdd:tag>Pronom PUID</fdd:tag>
				<fdd:values>
					<fdd:sigValues>
						<fdd:sigValue>fmt/294</fdd:sigValue>
					</fdd:sigValues>
					<fdd:note>For OpenDocument Spreadsheet 1.1. See <a href="http://www.nationalarchives.gov.uk/PRONOM/fmt/294">https://www.nationalarchives.gov.uk/PRONOM/fmt/294</a>.</fdd:note>
				</fdd:values>
			</fdd:other>
			<fdd:other>
				<fdd:tag>Wikidata Title ID</fdd:tag>
				<fdd:values>
					<fdd:sigValues>
						<fdd:sigValue>Q27203722</fdd:sigValue>
					</fdd:sigValues>
					<fdd:note>For OpenDocument Spreadsheet, version 1.1. See <a href="https://www.wikidata.org/wiki/Q27203722">https://www.wikidata.org/wiki/Q27203722</a>.</fdd:note>
				</fdd:values>
			</fdd:other>
		</fdd:signifiersGroup>
		<fdd:signifiersGroup>
			<fdd:filenameExtension>
				<fdd:sigValues>
					<fdd:sigValue>ots</fdd:sigValue>
				</fdd:sigValues>
				<fdd:note>The extension <i>.ots</i> is used for a spreadsheet document used as a template.</fdd:note>
			</fdd:filenameExtension>
			<fdd:internetMediaType>
				<fdd:sigValues>
					<fdd:sigValue>application/vnd.oasis.opendocument.spreadsheet-template</fdd:sigValue>
				</fdd:sigValues>
			</fdd:internetMediaType>
		</fdd:signifiersGroup>
	</fdd:fileTypeSignifiers>
	<fdd:notes>
		<fdd:general>
			<p>
				<b>Formulas in ODF 1.1:</b>  A cell containing a formula has a <i>table:formula</i> attribute.  The value of the attribute is a string representing the formula in some syntax.  ODF 1.1 does not prescribe the use of a particular syntax or provide a list of functions that can be included in formulas.  The description of the attribute in the specification provides some constraints.  A formula should begin with a namespace prefix, indicating the syntax and semantics used.   Several spreadsheet implementations used the <i>oooc:</i> namespace prefix adopted by OpenOffice.org.  However, some early implementations did not use a prefix, and Microsoft's first support for ODF (in Office 2007 Service Pack 2, released on April 28, 2009) introduced the prefix <i>msoxl:</i>.  This variability led to some interoperability problems and many blog posts about this ODF shortcoming. See <a href="#useful">Useful references</a> below.  Meanwhile, an OASIS subcommittee, formed in February 2006, was developing the OpenFormula specification, intended for inclusion in version 1.2 of the ODF specification, eventually published by OASIS in September 2011.  The emerging OpenFormula and ODF 1.2 specifications were tested in OpenOffice.org (starting with version 3.0 in Summer 2008) and other implementations.  Use of OpenFormula within ODF 1.1 files is indicated by the <i>of:</i> namespace prefix.  Software for conversion between OOXML and OpenFormula formulas was developed collaboratively as part of a more general translator between OOXML and ODF.   See <a href="http://odf-converter.sourceforge.net/newblog/index.php?2009/03">How the OpenXML/ODF Translator Deals with Formulas</a>.</p>
			<p>Typically, an ODF formula follows the namespace prefix with an equals (&apos;=&apos;) sign and can include the following components: numbers, text, named ranges, operators, function calls, or addresses of cells that contain numbers.  Addresses in ODF formulas start with &apos;[&apos; and end with &apos;]&apos;.  The ODF 1.1 specification provides details in subclause 8.3.1 as to how cells and ranges of cells should be addressed.</p>
			<p>
				<b>Relationship to CSV</b>:
The <fddLink id="fdd000323">CSV</fddLink> format is a simple textual format for rectangular datasets.
Rows represent observations and columns represent the variables measured.  The first row may hold labels for the variables.
Conversion from CSV to ODS is straightforward and offered as an import feature by most spreadsheet applications.  One caveat with import is that CSV imposes no limits to the precision of numeric value that can be represented. If numbers in a CSV file have more than 15 digits, the values will likely be rounded on conversion to ODS.

If an ODS worksheet consists simply of data values where rows represent observations and columns represent variables, export/conversion to CSV is straightforward and widely offered by spreadsheet applications. If the top row gives variable names it will typically be exported appropriately.  However, the exported file does not distinguish between raw data and calculated values.  This loss of semantics may be significant in some contexts.</p>
			<p>
				<b>Microsoft Excel support for ODF 1.1 files:</b>  According to <a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offdi/accd3022-5a6a-4520-89d4-1388ae0d513c">[MS-OFFDI] Microsoft Office File Format Documentation Introduction</a>, ODS 1.1 was introduced as a persistence format in Microsoft Office Excel 2007 Service Pack 2.  Starting with Excel 2013, ODS 1.1 files opened and modified will be saved as ODS 1.2 files.</p>
			<p>Excel 2007 SP2 handling in ODF 1.1 files of formulas in different namespaces is described in <a href="https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oodf/2a81c38c-9db9-4d78-ae2f-11ee205b8699">[MS-OODF]: 2.1.210 Section 8.1.3, Table Cell</a> in discussion of the attribute <i>table:formula</i>, when contained within the element <i>&lt;table:table-cell&gt;</i>, itself contained within a parent <i>&lt;office:spreadsheet \ table:table-row&gt;</i>.</p>
			<ul>
				<li>When saving the <i>table:formula</i> attribute, Excel 2007 precedes the formula string with the &quot;msoxl&quot; namespace and saves a formula string that follows [ISO/IEC-29500-1] section 18.17, except that workbook-names are written as literal values.</li>
				<li>When loading the attribute <i>table:formula</i>, Excel 2007 first looks at the namespace. If the namespace is “msoxl”, Excel 2007 will load the value of table:formula as a formula.   If the namespace is missing or unknown, the <i>table:formula</i> attribute is not loaded, and the value “office:value” is used instead. Hence the value displayed corresponds to the most recent value calculated, but the cell contains a static value rather than a formula that can be recalculated.  If the latest result of the formula was an error, Excel 2007 loads the <i>&lt;text:p&gt;</i> element and maps it to an Error data type. Error data types that Excel 2007 does not support are mapped to #VALUE!.</li>
			</ul>
			<p>Excel 2010 and 2013 handling in ODF 1.1 files of formulas in different namespaces is described in <a href="https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oodf2/5a2f914a-7b81-43e0-aa88-0b8d0f70717b">[MS-OODF2]: 2.1.209 Section 8.1.3, Table Cell</a> in discussion of the attribute <i>table:formula</i>, when contained within the element <i>&lt;table:table-cell&gt;</i>, itself contained within a parent <i>&lt;office:spreadsheet \ table:table-row&gt;</i>.</p>
			<ul>
				<li>When saving the <i>table:formula</i> attribute, Excel precedes the formula string with the &quot;of&quot; namespace and saves a formula string that follows the OpenFormula specification (ODF 1.2 Part 2).</li>
				<li> Formulas using the &apos;of&apos; namespace and those without a namespace are expected to follow the OpenFormula specification.  Formulas using the &apos;msoxl&apos; namespace follow [ISO/IEC-29500-1] section 18.17, except workbook-names are written as literal values.</li>
				<li> When loading the attribute <i>table:formula</i>, Excel first looks at the namespace.  If the namespace is &apos;of&apos;, &apos;msoxl&apos;, or not specified, Excel will attempt to load the value of <i>table:formula</i> as a formula.  When loading the <i>table:formula</i> attribute, if the namespace is unknown, the <i>table:formula</i> attribute is not loaded, and the value “office:value” is used instead.  Hence the value displayed corresponds to the most recent value calculated, but the cell contains a static value rather than a formula that can be re-calculated. If the result of the formula is an error, Excel loads the <i>&lt;text:p&gt;</i> element and maps it to an Error data type. Error data types that Excel does not support are mapped to #VALUE!</li>
			</ul>
			<p>See also notes on conversion between XLSX and ODS in <fddLink id="fdd000398">XLSX/OOXML_2012</fddLink>.</p>
		</fdd:general>
		<fdd:history>
			<p>The most substantial difference between ODF_spreadsheet_1_1 (ODS 1.1) and <fddLink id="fdd000439">ODF_spreadsheet_1_2</fddLink> (ODS 1.2) is the addition of the OpenFormula specification, which defines a syntax for cell formulas and rules for evaluation.  As a result, ODS 1.2 resolves many of the interoperability problems associated with ODS 1.1.</p>
			<p>See <fddLink id="fdd000425">ODF_package_1_2</fddLink> for discussion of changes to the ODF package between versions 1.1 and 1.2.</p>
			<p>See <fddLink id="fdd000247">ODF_family</fddLink> for more on the history of ODF in general.</p>
		</fdd:history>
	</fdd:notes>
	<fdd:formatSpecifications>
		<fdd:urls>
			<fdd:url>
				<fdd:urlGroup>
					<fdd:intro>Specifications as published by OASIS</fdd:intro>
					<fdd:urlList>
						<fdd:urlReference>
							<link>https://docs.oasis-open.org/office/v1.1/</link>
							<tag>Open Document Format for Office Applications (OpenDocument) Specification v1.1</tag>
							<comment>Provides links to all versions of specifications and supporting files for ODF 1.1.  Specifications available as ODT, PDF, and HTML.</comment>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://docs.oasis-open.org/office/v1.1/OS/OpenDocument-schema-v1.1.rng</link>
							<tag>Normative RNG schema for markup of primary content in ODF 1.1 files.</tag>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://docs.oasis-open.org/office/v1.1/OS/OpenDocument-manifest-schema-v1.1.rng</link>
							<tag>Normative RNG schema for mandatory manifest file for an ODF 1.1 package.</tag>
						</fdd:urlReference>
					</fdd:urlList>
				</fdd:urlGroup>
			</fdd:url>
			<fdd:url>
				<fdd:urlGroup>
					<fdd:intro>Specifications as published by ISO/IEC</fdd:intro>
					<fdd:urlList>
						<fdd:urlReference>
							<link>https://standards.iso.org/ittf/PubliclyAvailableStandards/c043485_ISO_IEC_26300_2006(E).zip</link>
							<tag>ISO/IEC 26300:2006.  Information technology -- Open Document Format for Office Applications (OpenDocument) v1.0</tag>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://standards.iso.org/ittf/PubliclyAvailableStandards/c059302_ISO_IEC_26300_2006_Amd_1_2012.zip</link>
							<tag>ISO/IEC 26300:2006. Information technology -- Open Document Format for Office Applications (OpenDocument) v1.0 -- Amendment 1: Open Document Format for Office Applications (OpenDocument) v1.1</tag>
							<comment>The ISO/IEC 26300:2006 standard was supplemented by the 2012 amendment to achieve equivalence to the OASIS ODF 1.1 specification. </comment>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://www.iso.org/standard/43485.html</link>
							<tag>ISO catalog record for ISO/IEC 26300:2006
Information technology — Open Document Format for Office Applications (OpenDocument) v1.0</tag>
							<comment>ISO/IEC 26300:2006/Amd 1:2012 was an amendment producing a specification equivalent to ODF 1.1.</comment>
						</fdd:urlReference>
					</fdd:urlList>
				</fdd:urlGroup>
			</fdd:url>
		</fdd:urls>
	</fdd:formatSpecifications>
	<fdd:usefulReferences>
		<fdd:urls>
			<fdd:url>
				<fdd:urlReference>
					<link>http://books.evc-cit.info/books/odbook/ch05.html</link>
					<tag>OASIS OpenDocument Essentials.  Chapter 5. Spreadsheets</tag>
					<comment>Based on ODF 1.1.</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://en.wikipedia.org/wiki/OpenOffice.org</link>
					<tag>Wikipedia entry for OpenOffice.org</tag>
					<comment>Lists ODF versions used as native format, starting with support for ODF 1.0 in OpenOffice.org version 2.</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://www.iana.org/assignments/media-types/application/vnd.oasis.opendocument.spreadsheet</link>
					<tag>IANA registration for MIME media type for ODS (ODF spreadsheet) documents.</tag>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>http://fileformats.archiveteam.org/wiki/ODS</link>
					<tag>Archiveteam.org entry for OpenDocument Spreadsheet</tag>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlGroup>
					<fdd:intro>Blog posts about the lack of specification for formulas and functions in ODF 1.1 and the associated interoperability problems.</fdd:intro>
					<fdd:urlList>
						<fdd:urlReference>
							<link>https://www.tbray.org/ongoing/When/200x/2005/10/01/Open-Office-Conference#p-3</link>
							<tag>Some OO.oCon Lessons:  Bad Formula Trouble. Tim Bray.  October 01, 2005</tag>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://docs.microsoft.com/en-us/archive/blogs/brian_jones/comments-from-tim-bray-on-opendocument</link>
							<tag>Comments from Tim Bray on OpenDocument.  By Brian Jones of Microsoft.  October 4, 2015</tag>
							<comment>Picks up on points made by Tim Bray and provides a perspective from the Microsoft Excel team.  Stimulated lots of comments.</comment>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://www.robweir.com/blog/2009/03/odf-spreadsheet-interoperability-theory-and-practice.html</link>
							<tag>ODF Spreadsheet Interoperability: Theory and Practice.  Rob Weir.  March 1, 2009</tag>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://www.robweir.com/blog/2009/05/update-on-odf-spreadsheet-interoperability.html</link>
							<tag>Update on ODF Spreadsheet Interoperability. Rob Weir.  May 3, 2009</tag>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://www.robweir.com/blog/2009/05/follow-up-on-excel-2007-sp2s-odf.html</link>
							<tag>A follow-up on Excel 2007 SP2’s ODF support.  Rob Weir.  May 7, 2009.</tag>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://web.archive.org/web/20160303165427/http://broadcast.oreilly.com/2009/05/odf-11-formula-support-in-office-sp2.html</link>
							<tag>Where everyone knows your name: ODF 1.1 formula support in Office SP2.  Rick Jelliffe.  May 8, 2009</tag>
							<comment>Includes two undated updates.</comment>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://docs.microsoft.com/en-us/archive/blogs/dmahugh/1-2-1</link>
							<tag>Doug Mahugh - Office Interoperability blog:  1 + 2 = 1? May 10, 2009</tag>
							<comment>From Microsoft.</comment>
						</fdd:urlReference>
					</fdd:urlList>
				</fdd:urlGroup>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://www.openoffice.org/dev_docs/features/3.0/</link>
					<tag>OpenOffice.org 3.0 New Features</tag>
					<comment>Announces support for ODF 1.2.</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://www.nouenoff.nl/downloads/LibreOffice_AOO_CompetitiveFeatureMatrix_20150318.pdf</link>
					<tag>Comparing LibreOffice and Apache OpenOffice</tag>
					<comment>Includes timeline of releases and links to release notes as well as detailed comparison of features.</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlGroup>
					<fdd:intro>Microsoft technical documents on its support for ODF_spreadsheet_1_1 in Office</fdd:intro>
					<fdd:urlList>
						<fdd:urlReference>
							<link>https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oodf/</link>
							<tag>[MS-OODF]: Office Implementation Information for ODF 1.1 Standards Support</tag>
							<comment>Applies to Office 2007.</comment>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oodf/2a81c38c-9db9-4d78-ae2f-11ee205b8699</link>
							<tag>[MS-OODF]:  2.1.210 Section 8.1.3, Table Cell</tag>
							<comment>Includes description of how Excel 2007 SP2 deals with formulas in different namespaces.</comment>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oodf2/0d8a7d9e-7f69-40a3-a8be-1b706f5a930c</link>
							<tag>[MS-OODF2]: Office Implementation Information for ODF 1.1 Version 2 Standards Support.</tag>
							<comment>Applies to Word, Excel, and PowerPoint in Office 2010 through 2019</comment>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://docs.microsoft.com/en-us/openspecs/office_standards/ms-oodf2/5a2f914a-7b81-43e0-aa88-0b8d0f70717b</link>
							<tag>[MS-OODF2]:  2.1.209 Section 8.1.3, Table Cell</tag>
							<comment>Includes description of how Excel 2010 and 2013 deal with formulas in different namespaces.</comment>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offdi/7ffd4731-47eb-46c0-a934-ea154df676d0</link>
							<tag>[MS-OFFDI]: Microsoft Excel Persistence Formats</tag>
							<comment>Lists OpenDocument Format as a persistence format for Excel, with links to ODF 1.1 and ODF 1.2 </comment>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offdi/accd3022-5a6a-4520-89d4-1388ae0d513c</link>
							<tag>[MS-OFFDI]: 3.5.2 Application and Versions</tag>
							<comment>Indicates that if an ODF 1.1 spreadsheet is opened in Excel 2013 or later and modified, it will be saved in ODF 1.2 format.</comment>
						</fdd:urlReference>
					</fdd:urlList>
				</fdd:urlGroup>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>http://odf-converter.sourceforge.net/newblog/index.php?2009/03/13/28-how-the-openxml-odf-translator-deals-with-formulas</link>
					<tag>Open XML / ODF Translator Add-ins for Office </tag>
					<comment>March 2009 blog post relates to versions 2.5 and 3 of the converter</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>http://odf-converter.sourceforge.net/download.html</link>
					<tag>Open XML / ODF Translator Add-ins for Office (version 4.0)</tag>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlGroup>
					<fdd:intro>Resources related to numerical precision.  The typical numerical precision in spreadsheet formats/applications, including LibreOffice) is the <i>double-precision floating-point</i> format, also referred to as <i>binary64</i>.</fdd:intro>
					<fdd:urlList>
						<fdd:urlReference>
							<link>https://en.wikipedia.org/wiki/Double-precision_floating-point_format</link>
							<tag>Wikipedia entry for double-precision floating-point format (binary64)</tag>
							<comment>As specified by IEEE 754 and IEC 60559.  IEEE 754-2008 and  ISO/IEC/IEEE 60559:2011 are identical standards for floating-point arithmetic.</comment>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://www.jstatsoft.org/article/view/v034i04</link>
							<tag>On the Numerical Accuracy of Spreadsheets. Journal of Statistical Software, Vol. 34, Issue 4, April 2010</tag>
							<comment>Based on Excel 2007 and other spreadsheet applications available in 2008, including Calc from OpenOffice.org.  Concludes, &quot;there is no safe choice among the spreadsheets here assessed.&quot;</comment>
						</fdd:urlReference>
					</fdd:urlList>
				</fdd:urlGroup>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://www.libreoffice.org/discover/calc/</link>
					<tag>LibreOffice Calc -- introduction</tag>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://wiki.documentfoundation.org/images/4/47/CG41-CalcGuideLO.pdf</link>
					<tag>LibreOffice Calc Guide: Working with Spreadsheets</tag>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://en.wikipedia.org/wiki/OpenFormula</link>
					<tag>Wikipedia entry for OpenFormula</tag>
					<comment>Provides some early history on the OpenFormula project and formation of the OASIS Technical Committee that developed the standard.</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://www.nationalarchives.gov.uk/pronom/fmt/290</link>
					<tag>PRONOM entry for fmt/294</tag>
					<comment>PRONOM information for OpenDocument Spreadsheet 1.1. PUID: fmt/294</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://www.wikidata.org/wiki/Q27203722</link>
					<tag>WikiData entry for Q27203722</tag>
					<comment>Information in WikiData for OpenDocument Spreadsheet, version 1.1. WikiData Title ID: Q27203722.</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlGroup>
					<fdd:intro>See also <fddLink id="fdd000247">ODF_Family</fddLink>.</fdd:intro>
				</fdd:urlGroup>
			</fdd:url>
		</fdd:urls>
	</fdd:usefulReferences>
</fdd:FDD>
