<?xml version="1.0" encoding="UTF-8"?>
<fdd:FDD id="fdd000510" titleName="Microsoft Office Excel 97-2003 Binary File Format (.xls, BIFF8)" shortName="MS-XLS" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:fdd="http://www.loc.gov/preservation/digital/formats/schemas/fdd/v1" xsi:schemaLocation="http://www.loc.gov/preservation/digital/formats/schemas/fdd/v1 http://www.loc.gov/preservation/digital/formats/schemas/fdd/v1/fdd-v1-2.xsd">
	<fdd:properties>
		<fdd:gdfrGenreSelection>
			<fdd:gdfrGenreAndSubgenres>
				<fdd:gdfrGenre>spreadsheet</fdd:gdfrGenre>
				<fdd:gdfrSubgenres>
					<fdd:gdfrSubgenre>dataset</fdd:gdfrSubgenre>
				</fdd:gdfrSubgenres>
			</fdd:gdfrGenreAndSubgenres>
		</fdd:gdfrGenreSelection>
		<fdd:formatCategories>
			<fdd:category>file-format</fdd:category>
		</fdd:formatCategories>
		<fdd:gdfrComposition>unitary</fdd:gdfrComposition>
		<fdd:gdfrForm>binary</fdd:gdfrForm>
		<fdd:gdfrConstraint>structured</fdd:gdfrConstraint>
		<fdd:gdfrBasis>symbolic</fdd:gdfrBasis>
		<fdd:gdfrDomains>
			<fdd:gdfrDomain>
				<fdd:value>office/business</fdd:value>
			</fdd:gdfrDomain>
		</fdd:gdfrDomains>
		<fdd:updates>
			<fdd:date>2024-05-10</fdd:date>
		</fdd:updates>
		<fdd:draftStatus>Full</fdd:draftStatus>
	</fdd:properties>
	<fdd:identificationAndDescription>
		<fdd:fullName>Microsoft Office Excel 97-2003 Binary File Format (.xls). Also known as BIFF8.</fdd:fullName>
		<fdd:description>
			<p>The Microsoft Excel Binary File format, with the .xls extension and referred to as XLS or MS-XLS, was the default format used for spreadsheets in Excel through Microsoft Office 2003.  The format is also referred to as Binary Interchange File Format (BIFF) in Microsoft&apos;s technical documentation.  This format description is primarily for version 8 of BIFF (BIFF8), introduced with Excel 97 in 1997.  Although it cannot support the latest functionality of the Excel application, BIFF8 has continued to be available as an alternative to the <fddLink id="fdd000398">XLSX/OOXML</fddLink> format, standardized as ISO/IEC 29500, for saving spreadsheet files in Excel.  As of late 2019, the documentation for <a href="https://docs.microsoft.com/en-us/deployoffice/compat/office-file-format-reference#file-formats-that-are-supported-in-excel">File formats that are supported in Excel</a>, from Microsoft, lists two variants of XLS format, distinguishing between &quot;Excel 5.0/95 Binary file format&quot; and &quot;Excel 97-Excel 2003 Binary file format.&quot; These correspond to BIFF5 and BIFF8, respectively.  See <a href="#notes">Notes</a> below for more detail on versions of BIFF.</p>
			<p>Although the XLS format is proprietary, since 2007 it has been covered by Microsoft&apos;s <a href="https://docs.microsoft.com/en-us/openspecs/dev_center/ms-devcentlp/1c24c7c8-28b0-4ce1-a47d-95fe1ff504bc">Open Specification Promise</a>.  The specification released in 2007 is available as <a href="http://download.microsoft.com/download/5/0/1/501ED102-E53F-4CE0-AA6B-B0F93629DDC6/Office/Excel97-2007BinaryFileFormat(xls)Specification.pdf">Microsoft Office Excel 97-2007 Binary File Format Specification [*.xls]</a>.  Since 2008, the structure for the XLS format used since Excel 97 has been kept up-to-date at <a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-xls/">[MS-XLS]</a>.</p>
			<p>The structure of an XLS file since 1993 (BIFF5/Excel 5.0) is an OLE (object linking and embedding) compound file as specified in <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/MS-CFB/">[MS-CFB]</a>.
 A CFB provides a file-system-like structure within a file for the storage of arbitrary, application-specific streams of data. It consists of <i>storages</i>, <i>streams</i>, and <i>substreams</i>. Each binary stream or substream is written as a series of binary records.
 An XLS file must contain a single Workbook stream which has a single Globals Substream with at least one sheet substream, which could be a Worksheet Substream, Chart Sheet Substream, Macro Sheet Substream, or Dialog Sheet Substream.  These streams and substreams employ BIFF8 encoding for component binary records.  A substream has a BoF (beginning of file) record that includes an indicator for the BIFF version.  Hence the mandatory Workbook Globals Substream can be used to recognize the BIFF version. An XLS file in BIFF8 (or BIFF5) encoding begins as follows, with all values given as they occur in the physical file, for example when viewed using a Hex dump utility:</p>
			<ul>
				<li>CFB header:<ul>
						<li>Header Signature for the CFB format with 8-byte Hex value D0CF11E0A1B11AE1.  <a href="https://web.archive.org/web/20221112073316/https://www.garykessler.net/library/file_sigs.html">Gary Kessler</a> notes that the beginning of this string looks like &quot;DOCFILE&quot;</li>
						<li>16 bytes of zeroes</li>
						<li>2-byte Hex value 3E00 indicating CFB minor version 3E</li>
						<li>2-byte Hex value 0300 indicating CFB major version 3 or value 0400 indicating CFB major version 4.  [Note:  All XLS files created recently by compilers of this resource (in versions of Excel for MacOS and Windows) and examined with a Hex dump utility have been based on CFB major version 3. <a href="../contact_format.shtml">Comments welcome</a>.]</li>
						<li>2-byte Hex value FFFE indicating little-endian byte order for all integer values.  This byte order applies to all CFB files.</li>
						<li>2-byte Hex value 0900 (indicating the sector size of 512 bytes used for major version 3) or 0C00 (indicating the sector size of 4096 bytes used for major version 4)</li>
						<li>480 bytes for remainder of the 512-byte header, which fills the first sector for a CFB of major version 3</li>
						<li>For a CFB of major version 4, the rest of the first sector, 3,584 bytes of zeroes</li>
					</ul>
				</li>
				<li>BoF (beginning of file) record for the mandatory Workbook Globals Substream, which must be the first substream in a BIFF8 XLS file:<ul>
						<li>2-byte BoF record number field. Hex value 0908.  09 indicates a BoF record.  08 indicates the BIFF version.</li>
						<li>2 bytes unspecified</li>
						<li>BoF record data, starting with 2-byte Hex value 0006, indicating BIFF8</li>
						<li>2-byte Hex value 0500, indicating that the substream stream for which this is the record data is the mandatory Workbook Globals Substream</li>
					</ul>
				</li>
			</ul>
			<p>Following the Workbook Globals Substream, the actual data, stored in substreams for Sheets, Charts, Macros, etc., will be stored, also in BIFF8 format.</p>
			<p>The XLS format was superseded as the default format for Microsoft Excel starting with Excel 2007 by <fddLink id="fdd000398">XLSX/OOXML</fddLink>, the primary XML-based spreadsheet format of the Office Open XML (<fddLink id="fdd000395">OOXML</fddLink>) family.</p>
		</fdd:description>
		<fdd:shortDescription>a proprietary Microsoft format for spreadsheets with extension .xls, the default format for Excel 97 through Excel 2003.  Also referred to as Binary Interchange File Format, version 8 (BIFF8).
</fdd:shortDescription>
		<fdd:productionPhase>Can be used in any production phase: for creating documents (initial state): for editing and review (middle-state); and for final distribution.</fdd:productionPhase>
		<fdd:relationships>
			<fdd:relationship>
				<fdd:typeOfRelationship>Subtype of</fdd:typeOfRelationship>
				<fdd:relatedTo>
					<fdd:id>fdd000380</fdd:id>
					<fdd:shortName>CFB_3</fdd:shortName>
					<fdd:titleName>Microsoft Compound File Binary File Format, Version 3</fdd:titleName>
				</fdd:relatedTo>
				<fdd:comment>The compilers of this resource have experimented with saving spreadsheets as XLS files in several recent versions of Excel. In all cases, the resulting file was in version 3 of CFB.  <a href="../contact_format.shtml">Comments welcome</a>.</fdd:comment>
			</fdd:relationship>
			<fdd:relationship>
				<fdd:typeOfRelationship>Has later version</fdd:typeOfRelationship>
				<fdd:relatedTo>
					<fdd:id>fdd000398</fdd:id>
					<fdd:shortName>XLSX/OOXML_2012</fdd:shortName>
					<fdd:titleName>XLSX Transitional (Office Open XML), ISO 29500:2008-2016, ECMA-376, Editions 1-5</fdd:titleName>
				</fdd:relatedTo>
			</fdd:relationship>
		</fdd:relationships>
	</fdd:identificationAndDescription>
	<fdd:localUse>
		<fdd:experience>Library staff creating spreadsheets as part of their duties typically use the <fddLink id="fdd000398">XLSX</fddLink> format.  As of late 2020, the Library of Congress has over 389,000 files with the .xls extension in its digital collections, with a total size of over 226 gigabytes.  The corresponding figures for the .xlsx extension are over 685,000 files with a total size of over 722 gigabytes.  These files come from several different sources. Some may be datasets acquired individually or as supplements to published articles. Other sources are archived websites and files acquired by the Manuscript Division in collections of &quot;papers&quot; from individuals or organizations. </fdd:experience>
		<fdd:preference>For works acquired for its collections, the list of <a href="http://www.loc.gov/preservation/resources/rfs/data.html">Library of Congress Recommended Formats Statement for Datasets</a> includes XLS (.xls) as a preferred format for datasets.</fdd:preference>
	</fdd:localUse>
	<fdd:sustainabilityFactors>
		<fdd:disclosure>The Microsoft Excel Binary XLS file format is proprietary but openly documented and covered by Microsoft&apos;s <a href="https://docs.microsoft.com/en-us/openspecs/dev_center/ms-devcentlp/1c24c7c8-28b0-4ce1-a47d-95fe1ff504bc">Open Specification Promise</a>.</fdd:disclosure>
		<fdd:documentation>The specification is available at <a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-xls/">[MS-XLS]: Excel (.xls) Binary File Format</a>.  This document is updated quite frequently; changes are documented.</fdd:documentation>
		<fdd:adoption>
			<p>Very widely used.  <a href="https://personal.utdallas.edu/~liebowit/book/sheets/sheet.html">The Market for Spreadsheets</a>, an extract from Chapter 8 of <i>Winners, Losers, and Microsoft: Competition and Antitrust in High Technology (2001)</i> by Stan J. Liebowitz found that the market share of Excel in sales of spreadsheet software grew steadily in the decade between 1988 and 1997.  Excel&apos;s dollar share overtook that of Lotus 1-2-3 in 1993, and by 1997, was 90%.  Thus, when the BIFF8 version of the XLS format was introduced, Excel dominated the spreadsheet software market.  Excel continues to be the market leader for professional spreadsheet use.  See, for example, <a href="https://www.quora.com/Is-Excel-the-best-spreadsheet-software-available">Is Excel the best spreadsheet software available?</a>, a 2018 question with answers from Quora.  Most new spreadsheets created using Excel will be in the default <fddLink id="fdd000398">XLSX/OOXML</fddLink> format, but a number of heavy spreadsheet users choose to use the XLS or XLSB formats for faster loading and saving.</p>
			<p>The corpus of existing spreadsheet documents on the open web has roughly equal numbers of the binary XLS format and the XML-based XLSX format. A Google search in December 2019 of the U.S. web by filetype yielded: .xls, 8,450,000; .xlsx, 7,630,000; .ods, 154,000.  The compilers of this resource acknowledge that searches of the web are not a reliable measure of adoption for spreadsheet file formats at the initial (creation) phase of a content lifecycle.  Most spreadsheets are private and those that are made available on the web are likely to be converted to the format considered most likely to be usable by the intended audience.</p>
			<p>All mainstream spreadsheet applications can import files in the BIFF8 version of the XLS format.  This includes: <a href="https://www.libreoffice.org/discover/calc/">LibreOffice Calc</a>, <a href="https://www.openoffice.org/product/calc.html">Apache OpenOffice Calc</a>, Quattro Pro (now part of <a href="https://www.wordperfect.com/static/wpo/product_content/wordperfect/x9/wpox9-family-comparison-chart-en.pdf">Corel WordPerfect Office</a>), <a href="https://www.google.com/sheets/about/">Google Sheets</a>, and Apple&apos;s <a href="https://www.apple.com/numbers/">Numbers</a>. See also <a href="https://en.wikipedia.org/wiki/Comparison_of_spreadsheet_software#Supported_file_formats">table of supported formats in spreadsheet software</a> from Wikipedia.</p>
			<p>The binary XLS format, particularly BIFF8, appears relatively frequently on lists of acceptable formats for archiving of data.  For example, see recommendations from the <a href="http://www.loc.gov/preservation/resources/rfs/data.html">Library of Congress</a>, the <a href="https://www.ukdataservice.ac.uk/manage-data/format/recommended-formats.aspx">UK Data Service</a>, the <a href="https://www.naa.gov.au/information-management/storing-and-preserving-information/preserving-information/preserving-digital-information/born-digital-file-format-standards">National Archives of Australia</a>, and the <a href="https://www.archives.gov/records-mgmt/policy/transfer-guidance-tables.html#structuredata">U.S. National Archives (NARA)</a>. In this context, the assumption is usually that the data per se is stored in a worksheet as a rectangular grid with columns representing variables/measurements and rows representing columns.  Note that recommended practice for archiving datasets always calls for a &quot;codebook&quot; or other documentation that explains both the scope and context for the data&apos;s collection and descriptions for each variable, but does not expect such metadata to be in the same file as the data. For example, see guidance from the <a href="https://www.ukdataservice.ac.uk/manage-data">UK Data Archive</a>, <a href="https://dmptool.org/general_guidance#file-formats">DMPtool</a> from the University of California Curation Center, and the <a href="https://datadryad.org/docs/QuickstartGuideToDataSharing.pdf">Dryad Digital Repository</a>.</p>
			<p>The <a href="http://fileformats.archiveteam.org/wiki/XLS">XLS page at fileformats.archiveteam.org</a> lists some open-source software libraries available for manipulating files in the binary file format used as the native format by Microsoft Excel 97, 2000, 2002, and Office Excel 2003. <a href="http://decalage.info/file_formats_security/office">Weaponized MS Office 97-2003 legacy/binary formats (doc, xls, ppt, ...)</a> also lists software libraries.  Python &quot;packages&quot; for working with .xls files are listed at <a href="http://www.python-excel.org/">Working with Excel Files in Python</a>. The compilers of this resource have not determined the extent to which any of the software listed  in these resources is actively maintained.  <a href="../contact_format.shtml">Comments welcome</a>.</p>
			<p>
				<a href="https://www.gaia-gis.it/fossil/freexl/index">FreeXL</a> is an open source library to extract valid data from within an Excel (.xls) spreadsheet; this software completely ignores user-interface details. See <a href="http://www.gaia-gis.it/gaia-sins/freexl-1.0.5-doxy-doc/html/OtherTools.html">FreeXL: Other tools and libraries</a> for a list of software supporting the XLS format that was compiled by the author of FreeXLS.</p>
			<p>Widely used commercial data analysis or file conversion packages that can read and write XLS files include: <a href="https://www.leadtools.com/help/leadtools/v20/dh/to/file-formats-microsoft-excel-spreadsheet-xlsx-xls.html">LeadTools</a>; <a href="https://docs.safe.com/fme/html/FME_Desktop_Documentation/FME_ReadersWriters/xlsx/xlsx.htm">FME from Safe Software</a>; <a href="https://reference.wolfram.com/language/ref/format/XLS.html">Mathematica</a>; <a href="https://www.maplesoft.com/support/help/Maple/view.aspx?path=ExcelTools">Maple</a>.  File conversion packages that can read XLS files but not write them include:  <a href="https://products.aspose.com/cells">Aspose Cells</a> (including a free online viewer at <a href="https://products.aspose.app/cells/viewer">https://products.aspose.app/cells/viewers</a>).  A number of other file conversion utilities that claim to convert XLS files to XLSX include: <a href="https://www.zamzar.com/convert/xls-to-xlsx/">Zamzar</a>; <a href="http://xlsgen.arstdesign.com/">xlsgen</a>; and <a href="https://www.docspal.com/convert/xls-to-xlsx">docspal</a>.</p>
		</fdd:adoption>
		<fdd:licensingAndPatents>
			<p>Covered by Microsoft&apos;s <a href="https://docs.microsoft.com/en-us/openspecs/dev_center/ms-devcentlp/1c24c7c8-28b0-4ce1-a47d-95fe1ff504bc">Open Specification Promise</a>, whereby Microsoft &quot;irrevocably promises&quot; not to assert any claims against those making, using, and selling conforming implementations of any specification covered by the promise (so long as those accepting the promise refrain from suing Microsoft for patent infringement in relation to Microsoft&apos;s implementation of the covered specification).</p>
			<p>New features introduced into XLS may be subject to patent protection.  However, Microsoft&apos;s <a href="https://docs.microsoft.com/en-us/openspecs/dev_center/ms-devcentlp/d84cac00-b312-44ee-9156-23bde6477c3d#patent-pledges">interoperability principles</a> indicate &quot;Microsoft will also make available a list of any of its patents that cover any extensions, and will make available patent licenses on reasonable and non-discriminatory terms.&quot;  As of November 2019, the <a href="https://patentmap.blob.core.windows.net/public-patents-export/patmap-tool.html">patent map tool</a> provided by Microsoft indicates that there no patents of concern to users of the [MS-XLS] specification or the [MS-CFB] specification on which it is based.</p>
		</fdd:licensingAndPatents>
		<fdd:transparency>The XLS formats (all BIFF versions) are not easily interpreted with basic tools.  This is due to techniques used to keep files small and fast to load, such as the use of numeric codes to identify record types, and having the length of each record declared in the file, rather than using fixed-length records or recognizable delimiters for records.</fdd:transparency>
		<fdd:selfDocumentation>
			<p>Options for storing document-level metadata in an XLS file are described in a subsidiary specification, <a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-oshared/d93502fa-5b8f-4f47-a3fe-5574046f4b8d">[MS-OSHARED]</a>. An XLS file should include a Summary Information property set, which can include the following optional descriptive properties: Title, Author, Subject (description), Keywords, Comments.  See <a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-oshared/87667163-ea1e-4d67-9eec-47cad74e8030">2.3.3.2.1.1 PIDSI</a>.  An XLS file may contain an additional property set (known as Document Summary Information) with a fixed set of properties, including Manager and Company names.  User-defined or custom properties are also allowed.  See also <a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-oshared/9673a168-c715-44eb-8825-02cfa2b4627d">2.3.3 Property Set Storage</a>.</p>
			<p>The [MS-XLS] specification offers no support for embedding metadata in an externally defined schema.</p>
			<p>
				<b>Accessibility Features</b>
			</p>
			<p>MS-XLS offers limited accessibility support. Accessibility features for this format primarily depend on access to the data using accessibility or assistive features of an application such as Microsoft Excel, in order to navigate files using a screen reader or other application-based tools. ScreenTips may be added to content within XLS / BIFF8 files, which can enable more robust description using a screen reader. ScreenTips are supported through the use of two specific record types: the <a href="https://learn.microsoft.com/en-us/openspecs/office_file_formats/ms-xls/dd34df60-8250-40a9-83a3-911476a31ea7">OBJ record</a> and the <a href="https://learn.microsoft.com/en-us/openspecs/office_file_formats/ms-xls/0e5d0256-6d86-4628-a6fa-ce2e948673b0">NOTE record </a>.</p>
			<p>Microsoft offers some guidance in <a href="https://support.microsoft.com/en-us/office/make-your-excel-documents-accessible-to-people-with-disabilities-6cc05fc5-1314-48b5-8eb3-683e49b3e593">online tutorials</a> for making spreadsheets accessible, and though this guidance is written for Microsoft 365 applications, there are topics guidelines which may be applied across versions and formats.</p>
		</fdd:selfDocumentation>
		<fdd:externalDependencies>An XLS workbook may pull in data from external data sources, for example, by querying a remote database.</fdd:externalDependencies>
		<fdd:techProtection>Since XLS workbooks can contain sensitive information that needs to be protected, XLS files can be protected by encryption that requires a password to decrypt.  Several encryption approaches are supported for password protection, as described at <a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offcrypto/2d1c4f2c-7a2a-4133-998f-f3373f00d542">1.3.3 Encryption</a>, within <a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offcrypto/">[MS-OFFCRYPTO]</a>.  This clause indicates that the XLS format may use <i>XOR obfuscation</i>, <i>40-bit RC4 encryption</i>, or <i>CryptoAPI RC4 encryption</i>.  See <a href="">2.2.10 Encryption (Password to Open)</a> from [MS-XLS] for details of which streams in an XLS file are encrypted.</fdd:techProtection>
	</fdd:sustainabilityFactors>
	<fdd:qualityAndFunctionalityFactors>
		<fdd:textQF>
			<fdd:normalText>
				<p>No specific set of factors for assessing quality and functionality of a spreadsheet format has been developed. Since some spreadsheets have a printable or viewable report as a primary function and others are primarily containers for tabular data, selected factors for assessing formats for text and datasets are relevant.  In general, functionality supported in an XLS file is similar to that supported in an <fddLink id="fdd000398">XLSX</fddLink> file, except that features added to Excel since 2007, as documented in <a href="https://docs.microsoft.com/en-us/openspecs/office_standards/ms-xlsx/2c5dee00-eff2-4b22-92b6-0738acd4475e">[MS-XLSX]: Excel (.xlsx) Extensions to the Office Open XML SpreadsheetML File Format</a> may not be supported.</p>
				<p>BIFF8 was the first encoding for the XLS format that supported Unicode, stored as UTF-16LE (i.e. as UTF-16 in little-endian byte order).  Character sets for prior versions of BIFF were based on Windows &quot;<a href="https://en.wikipedia.org/wiki/Windows_code_page">code pages</a>.&quot;</p>
			</fdd:normalText>
		</fdd:textQF>
		<fdd:datasetQF>
			<fdd:normalDataset>
				<p>No specific set of factors for assessing quality and functionality of a spreadsheet format has been developed.  Once loaded into a spreadsheet application that supports the XLS format, the functionality of a spreadsheet in the XLS format is expected to be identical to that of the <fddLink id="fdd000398">XLSX/OOXML</fddLink> format.</p>
				<p>The maximum number of rows for an XLS file is 65535. The maximum number of columns is 255.  The maximum dimensions of an XLSX file are 1048576 rows and 16384 columns.  New features added to Microsoft Excel since 2007 are not necessarily supported in the XLS format.  Examples include <a href="https://blogs.msdn.microsoft.com/mvpawardprogram/2013/07/15/excel-2013-timelines/">Timeline Slicers</a>  (introduced in 2013) and <a href="https://support.office.com/en-us/article/excel-data-types-stocks-and-geography-61a33056-9935-484f-8ac8-f1a89e210877">Excel data types for Stocks and Geography</a> (introduced in 2019).</p>
			</fdd:normalDataset>
			<fdd:accessSoftware>Microsoft has provided tools that allow developers to work with XLS spreadsheets programmatically, including Visual Basic for Applications (<a href="https://docs.microsoft.com/en-us/office/vba/api/overview/library-reference">VBA</a>) and <a href="https://www.pcmag.com/encyclopedia/term/40016/com-automation">COM (component object model) Automation</a>.  For a brief introduction, see <a href="https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/understanding-automation">Understanding automation</a> from Microsoft. See also <a href="https://www.joelonsoftware.com/2008/02/19/why-are-the-microsoft-office-file-formats-so-complicated-and-some-workarounds/">Why are the Microsoft Office file formats so complicated? (And some workarounds)</a>, a post from 2008 on the Joel On Software blog.</fdd:accessSoftware>
			<fdd:dataDocumentation>The XLS formats have no specific support for embedding rich discipline-specific metadata or codebooks. See Self-documentation in <a href="#sustainability">Sustainability Factors</a> above.</fdd:dataDocumentation>
			<fdd:beyondDataset>See <fddLink id="fdd000398">XLSX/OOXML</fddLink>.</fdd:beyondDataset>
		</fdd:datasetQF>
	</fdd:qualityAndFunctionalityFactors>
	<fdd:fileTypeSignifiers>
		<fdd:signifiersGroup>
			<fdd:filenameExtension>
				<fdd:sigValues>
					<fdd:sigValue>xls</fdd:sigValue>
				</fdd:sigValues>
				<fdd:note>Documented in the specification and elsewhere by Microsoft in many locations, for example at <a href="https://blogs.msdn.microsoft.com/vsofficedeveloper/2008/05/08/office-2007-file-format-mime-types-for-http-content-streaming-2/">Office 2007 File Format MIME Types for HTTP Content Streaming</a>.</fdd:note>
			</fdd:filenameExtension>
			<fdd:internetMediaType>
				<fdd:sigValues>
					<fdd:sigValue>application/vnd.ms-excel</fdd:sigValue>
				</fdd:sigValues>
				<fdd:note>Documented by Microsoft at <a href="https://blogs.msdn.microsoft.com/vsofficedeveloper/2008/05/08/office-2007-file-format-mime-types-for-http-content-streaming-2/">Office 2007 File Format MIME Types for HTTP Content Streaming</a>.  Also listed at <a href="https://www.iana.org/assignments/media-types/media-types.xhtml#application">IANA</a>.  See 1996 registration at <a href="https://www.iana.org/assignments/media-types/application/vnd.ms-excel">https://www.iana.org/assignments/media-types/application/vnd.ms-excel</a>.</fdd:note>
			</fdd:internetMediaType>
			<fdd:magicNumbers>
				<fdd:sigValues>
					<fdd:sigValue>Hex: D0 CF 11 E0 A1 B1 1A E1</fdd:sigValue>
				</fdd:sigValues>
				<fdd:note>Documented in the CFB specification, in <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-cfb/05060311-bfce-4b12-874d-71fd4ce63aea">2.2 Compound File Header</a>.  Applies to all files in CFB format; see <a href="https://web.archive.org/web/20221112073316/https://www.garykessler.net/library/file_sigs.html">GCK&apos;S File Signatures Table</a> entry for Compound Binary File format (aka OLECF).</fdd:note>
			</fdd:magicNumbers>
			<fdd:other>
				<fdd:tag>File signature</fdd:tag>
				<fdd:values>
					<fdd:sigValues>
						<fdd:sigValue>Hex: 3E 00 03 00 FE FF 09 00 </fdd:sigValue>
					</fdd:sigValues>
					<fdd:note>At byte offset 24 from beginning of file.  Indicates CFB (Compound File Binary format) major version 3, minor version 3e.  Assumes that all .XLS files in BIFF8 format, use this version of CFB.  <a href="../contact_format.shtml">Comments welcome</a>.</fdd:note>
				</fdd:values>
			</fdd:other>
			<fdd:other>
				<fdd:tag>File signature</fdd:tag>
				<fdd:values>
					<fdd:sigValues>
						<fdd:sigValue>Hex 0908....00060500</fdd:sigValue>
					</fdd:sigValues>
					<fdd:note>At byte offset 512 from beginning of file, according to PRONOM records for <a href="http://www.nationalarchives.gov.uk/PRONOM/fmt/61">fmt/61</a> and <a href="http://www.nationalarchives.gov.uk/PRONOM/fmt/62">fmt/62</a>.  This is the beginning of the first BIFF stream in the CFB container.  This assumes the first BIFF stream is the Workbook Globals Substream.  According to <a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-xls/ca4c1748-8729-4a93-abb9-4602b3a01fb1">[MS-XLS] 2.1.7.20.3 Globals Substream</a>, &quot;There MUST be exactly one Globals Substream in a Workbook Stream ... , and the Globals Substream MUST be the first substream in the Workbook Stream.&quot;</fdd:note>
				</fdd:values>
			</fdd:other>
			<fdd:other>
				<fdd:tag>Other</fdd:tag>
				<fdd:values>
					<fdd:sigValues>
						<fdd:sigValue>NF00263</fdd:sigValue>
					</fdd:sigValues>
					<fdd:note>See NARA File Format Preservation Plan ID <a href="https://www.archives.gov/files/lod/dpframework/id/NF00245.ttl">https://www.archives.gov/files/lod/dpframework/id/NF00263.ttl</a> for Microsoft Excel 97.
					</fdd:note>
				</fdd:values>
			</fdd:other>
			<fdd:other>
				<fdd:tag>Pronom PUID</fdd:tag>
				<fdd:values>
					<fdd:sigValues>
						<fdd:sigValue>fmt/61</fdd:sigValue>
						<fdd:sigValue>fmt/62</fdd:sigValue>
					</fdd:sigValues>
					<fdd:note>PRONOM has a number of entries for Microsoft spreadsheet format variants with the .xls extension.  The PRONOM entries that appear to correspond to the scope of this format description are <a href="http://www.nationalarchives.gov.uk/PRONOM/fmt/61">http://www.nationalarchives.gov.uk/PRONOM/fmt/61</a> and <a href="http://www.nationalarchives.gov.uk/PRONOM/fmt/62">http://www.nationalarchives.gov.uk/PRONOM/fmt/62</a>.</fdd:note>
				</fdd:values>
			</fdd:other>
			<fdd:other>
				<fdd:tag>Wikidata Title ID</fdd:tag>
				<fdd:values>
					<fdd:sigValues>
						<fdd:sigValue>Q28858068</fdd:sigValue>
					</fdd:sigValues>
					<fdd:note>See <a href="https://www.wikidata.org/wiki/Q28858068">https://www.wikidata.org/wiki/Q28858068</a> for Binary Interchange File Format, version 8 (aka BIFF8)</fdd:note>
				</fdd:values>
			</fdd:other>
		</fdd:signifiersGroup>
	</fdd:fileTypeSignifiers>
	<fdd:notes>
		<fdd:general>
			<p>
				<b>Versions of BIFF, the &quot;binary interchange file format,&quot;</b> were used as the default formats for Excel spreadsheets, with the file extension <i>.xls</i>, until superseded in Excel 2007 by the XML-based <fddLink id="fdd000398">XLSX/OOXML</fddLink>.  Excel spreadsheet files with the .xls extension are not all in a single format.  For versions of Excel through Excel 4.0 (1992), spreadsheet files could contain only a single worksheet; those early XLS files consisted of a single BIFF stream (through BIFF4).  <a href="http://www.gaia-gis.it/gaia-sins/freexl-1.0.5-doxy-doc/html/Format.html">About the .xls binary format</a>, a description from FreeXML, an open-source library to extract data from an XLS spreadsheet, indicates, &quot;There is no .xls file format. It's really a common file suffix applied to many different things.&quot; The FreeXML description has a table relating the different versions of BIFF to versions of Excel.  Useful details of the early formats are in <a href="https://www.openoffice.org/sc/excelfileformat.pdf">OpenOffice.org&apos;s Documentation of the Microsoft Excel File Format</a>, covering Excel versions 2, 3, 4, 5, 95, 97, 2000, XP, and 2003.  Microsoft&apos;s own 2007 documentation for the .xls format is available as <a href="http://download.microsoft.com/download/5/0/1/501ED102-E53F-4CE0-AA6B-B0F93629DDC6/Office/Excel97-2007BinaryFileFormat(xls)Specification.pdf">Microsoft Office Excel 97-2007 Binary File Format Specification [*.xls]</a>, which covers BIFF documentation for Excel versions 5, 95, 97, 2000, 2002, 2003, and 2007.</p>
			<p>The early XLS formats, used for Excel 2.0 (1987) through Excel 4.0 (1992), allowed only a single worksheet.  The corresponding file formats were single BIFF streams. </p>
			<ul>
				<li>
					<b>BIFF2</b> for Excel 2.0 (1987)</li>
				<li>
					<b>BIFF3</b> for	Excel 3.0 	(1990)</li>
				<li>
					<b>BIFF4</b> for	Excel 4.0 (1992)</li>
			</ul>
			<p>Note that the extension .xlw was used to support multi-sheet &quot;workspaces&quot; starting with Excel 3.0.  However, the .xlw file did not contain user data; it was used to configure Excel&apos;s user interface presentation of the component sheets.  See <a href="https://www.reviversoft.com/file-extensions/xlw">.xlw File Extension | ReviverSoft</a> for more detail.</p>
			<p>With BIFF5, a new structure was introduced; an XLS file now represented a single <i>Workbook</i> with one or many individual <i>Worksheets</i>. A number of streams, including BIFF streams for individual worksheets, are stored in a Microsoft Compound File Binary File container.   The compilers of this resource have experimented with saving spreadsheets as XLS files in current versions of Excel.  In all cases, the resulting file was in version 3 of CFB (<fddLink id="fdd000380">MS-CFB3</fddLink>).  <a href="../contact_format.shtml">Comments welcome</a>.  In BIFF7 and earlier, a record in a BIFF stream has a length limit of 2,084 bytes, including the record type and record length fields.</p>
			<ul>
				<li>
					<b>BIFF5</b> for Excel 5.0 (1993) and Excel 95 (1995)</li>
				<li>
					<b>BIFF7</b> was for an option available in Excel 97. Microsoft&apos;s 2007 Specification for <a href="http://download.microsoft.com/download/5/0/1/501ED102-E53F-4CE0-AA6B-B0F93629DDC6/Office/Excel97-2007BinaryFileFormat(xls)Specification.pdf">Microsoft Office Excel 97-2007 Binary File Format (*.xls)</a> states, &quot;For improved backward compatibility, Excel 97 has a save file type option: Microsoft Excel 97 &amp; 5.0/95 Workbook. When a workbook is saved using this file type, Excel writes two complete book streams. The first stream in the file is the Microsoft Excel 5.0/95 format (BIFF5/BIFF7), and the second one is the Microsoft Excel 97 format (BIFF8). The DSF record, which only appears in the BIFF8 stream, indicates the file is a <i>double stream file</i>. To distinguish the two streams, the BIFF5/BIFF7 stream is called Book, and the BIFF8 stream is called Workbook.&quot;</li>
				<li>
					<b>BIFF8</b> for	Excel 98 (1998) through Excel 2003.  In BIFF8, a BIFF record has a length limit of 8,228 bytes, including the record type and record length fields.  As noted above, Excel 97 introduced the BIFF8 format in its double-stream file option.  This format description is primarily for the BIFF8 variant of the XLS format.</li>
			</ul>
			<p>Note that <b>BIFF12</b> is used in a different binary file format, using a different container file and the file extension <i>.xlsb</i>.  It has been available as an alternative to the XML-based <fddLink id="fdd000398">XLSX</fddLink> since Excel 2007.  See <fddLink id="fdd000512">MS-XLSB</fddLink>.</p>
			<p>
				<b>Detecting the BIFF version in an XLS file</b>: A <i>BoF</i> record, identified by the record type byte (byte 1) with value of Hex 09, marks the beginning of a Book or Workbook stream in a BIFF file.  For BIFF2 through BIFF4, the file consists of a single stream and the BIFF version is found from the high-order byte (byte 0) of the record number field in the BoF record that begins the file.  The values that identify these BIFF versions are: Hex 00 for BIFF2; Hex 02 for BIFF3; Hex 04 for BIFF4.</p>
			<p>For BIFF5, BIFF7 and BIFF8, the BIFF version is not identified so close to the beginning of the file, because the start of the file identifies the file as a CFB container.  According to <a href="https://www.openoffice.org/sc/excelfileformat.pdf">OpenOffice.org&apos;s Documentation of the Microsoft Excel File Format</a>, the BIFF version can be identified in the BIFF stream that represents the Workbook Globals Substream.  Within this BIFF stream, the two-byte <i>vers</i> field at offset 4 identifies the BIFF version.  This field is Hex 0500
for BIFF5 or BIFF7 and Hex 0600
for BIFF8.</p>
		</fdd:general>
		<fdd:history>The BIFF8 version of Microsoft&apos;s XLS format (MS-XLS) was introduced in 1997 and was the default file format for Microsoft Excel Workbooks through Excel 2003.  See General notes, immediately above, for information on chronological versions of BIFF.  Starting with Excel 2007, the default format for Excel Workbooks has been <fddLink id="fdd000398">XLSX/OOXML</fddLink>.</fdd:history>
	</fdd:notes>
	<fdd:formatSpecifications>
		<fdd:urls>
			<fdd:url>
				<fdd:urlReference>
					<link>https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-xls/</link>
					<tag>[MS-XLS]: Excel Binary File Format (.xls) Structure (latest version)</tag>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://docs.microsoft.com/en-us/openspecs/windows_protocols/MS-CFB/</link>
					<tag>[MS-CFB]: Compound File Binary File Format</tag>
					<comment>XLS is a subtype of the Compound File Binary File Format.</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlGroup>
					<fdd:intro>Subsidiary specifications describe data types and data structures that are used in common by documentation for Microsoft Office 97, Microsoft Office XP, Microsoft Office 2003, and the 2007 Microsoft Office system.</fdd:intro>
					<fdd:urlList>
						<fdd:urlReference>
							<link>https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-oshared/</link>
							<tag>[MS-OSHARED]: Office Common Data Types and Objects Structures</tag>
							<comment>Includes property sets that can store document-level properties (metadata).</comment>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://docs.microsoft.com/en-us/openspecs/windows_protocols/MS-OLEPS/</link>
							<tag>[MS-OLEPS]: Object Linking and Embedding (OLE) Property Set Data Structures</tag>
							<comment>Property sets in XLS documents are stored as OLE items.</comment>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offcrypto/</link>
							<tag>[MS-OFFCRYPTO]: Office Document Cryptography Structure (latest version)</tag>
						</fdd:urlReference>
					</fdd:urlList>
				</fdd:urlGroup>
			</fdd:url>
			<fdd:url>
				<fdd:urlGroup>
					<fdd:intro>The first version of the the Microsoft Office Excel 97-2003 Binary File Format (.xls) Specification published under the Open Specification Promise was published in 2007 as Microsoft Office Excel 97-<b>2007</b> Binary File Format (.xls) Specification.</fdd:intro>
					<fdd:urlList>
						<fdd:urlReference>
							<link>http://download.microsoft.com/download/5/0/1/501ED102-E53F-4CE0-AA6B-B0F93629DDC6/Office/Excel97-2007BinaryFileFormat(xls)Specification.pdf</link>
							<tag>Microsoft Office Excel 97-2007 Binary File Format Specification (as of 2007) | available from Microsoft</tag>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://hdl.loc.gov/loc.gdc/digformat.000003.1</link>
							<tag>Microsoft Office Excel 97-2007 Binary File Format Specification (as of 2007) | available from Library of Congress</tag>
						</fdd:urlReference>
					</fdd:urlList>
				</fdd:urlGroup>
			</fdd:url>
		</fdd:urls>
	</fdd:formatSpecifications>
	<fdd:usefulReferences>
		<fdd:urls>
			<fdd:url>
				<fdd:urlReference>
					<link>https://www.openoffice.org/sc/excelfileformat.pdf</link>
					<tag>OpenOffice.org&apos;s Documentation of the Microsoft Excel File Format (2008)</tag>
					<comment>Compiled between 2001 and 2008.</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>http://www.openoffice.org/sc/compdocfileformat.pdf</link>
					<tag>OpenOffice.org&apos;s Documentation of the Microsoft Compound Document File Format (2007)</tag>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlGroup>
					<fdd:intro>The documentation for FreeXL has a useful description of the XLS format and its variants.</fdd:intro>
					<fdd:urlList>
						<fdd:urlReference>
							<link>https://www.gaia-gis.it/gaia-sins/freexl-1.0.6-doxy-doc/html/Format.html</link>
							<tag>About the .xls binary format | FreeXL</tag>
							<comment>Version of FreeXL current as of late 2020.</comment>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://web.archive.org/web/20200123133556/http://www.gaia-gis.it/gaia-sins/freexl-1.0.5-doxy-doc/html/Format.html</link>
							<tag>FreeXL  1.0.5 | About the .xls binary format</tag>
							<comment>Link via Internet Archive.  The URL for this content changes with new editions of FreeXL.</comment>
						</fdd:urlReference>
					</fdd:urlList>
				</fdd:urlGroup>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://docs.microsoft.com/en-us/deployoffice/compat/office-file-format-reference</link>
					<tag>File format reference for Word, Excel, and PowerPoint | from Microsoft</tag>
					<comment>Applies to recent versions of Microsoft Office.</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://docs.microsoft.com/en-us/openspecs/office_standards/ms-xlsx/2c5dee00-eff2-4b22-92b6-0738acd4475e</link>
					<tag>[MS-XLSX]: Excel (.xlsx) Extensions to the Office Open XML SpreadsheetML File Format</tag>
					<comment>Features specified in this document are not necessarily supported by the XLS format.</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlGroup>
					<fdd:intro>Examples of new features supported in Excel that are not supported in XLS files include Rich Data Types (introduced in 2019) and Timelines (introduced in 2013).</fdd:intro>
					<fdd:urlList>
						<fdd:urlReference>
							<link>https://blogs.msdn.microsoft.com/mvpawardprogram/2013/07/15/excel-2013-timelines/</link>
							<tag>Excel 2013 Timelines (introduced in 2013)</tag>
							<comment/>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://www.youtube.com/watch?v=HkEdLjtcut8</link>
							<tag>What&apos;s New in Excel 2013 - Timeline Slicers</tag>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://support.office.com/en-us/article/excel-data-types-stocks-and-geography-61a33056-9935-484f-8ac8-f1a89e210877</link>
							<tag>Excel data types: Stocks and geography (introduced in 2019)</tag>
						</fdd:urlReference>
						<fdd:urlReference>
							<link>https://www.howtoexcel.org/general/data-types/</link>
							<tag>The Complete Guide to Rich Data Types in Excel</tag>
							<comment>The Stocks and Geography datatypes are not single values, but connections to an online data source that provides more information about the data.</comment>
						</fdd:urlReference>
					</fdd:urlList>
				</fdd:urlGroup>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://en.wikipedia.org/wiki/Microsoft_Excel</link>
					<tag>Wikipedia entry for Microsoft Excel</tag>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://en.wikipedia.org/wiki/Comparison_of_spreadsheet_software#Supported_file_formats</link>
					<tag>Wikipedia table of formats supported by spreadsheet software applications</tag>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://www.quora.com/Is-Excel-the-best-spreadsheet-software-available</link>
					<tag>Is Excel the best spreadsheet software available? (2018)</tag>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>http://fileformats.archiveteam.org/wiki/XLS</link>
					<tag>XLS page from Let&apos;s Solve the File Format Problem!</tag>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://www.joelonsoftware.com/2008/02/19/why-are-the-microsoft-office-file-formats-so-complicated-and-some-workarounds/</link>
					<tag>Why are the Microsoft Office file formats so complicated? (And some workarounds).  From Joel On Software (2008).</tag>
					<comment>Mentions use of Visual Basic for Applications (VBA) and COM Automation for working programmatically with Office binary formats. </comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://docs.microsoft.com/en-us/archive/blogs/openspecification/determining-office-binary-file-format-types</link>
					<tag>Determining Office Binary File Format Types (2013) | from Microsoft Open Specifications Support Team Blog</tag>
					<comment>Uses a file in Excel 97-2003 Workbook format as an example</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>http://decalage.info/file_formats_security/office</link>
					<tag>Weaponized MS Office 97-2003 legacy/binary formats (doc, xls, ppt, ...) | from Decalage</tag>
					<comment>Has many useful links related to Microsoft binary formats, with an emphasis on security.  No longer actively updated.</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>http://www.nationalarchives.gov.uk/PRONOM/fmt/61</link>
					<tag>PRONOM entry for fmt/61</tag>
					<comment>Information in PRONOM on Microsoft Excel 97 Workbook (version 8).  PUID: fmt/61</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>http://www.nationalarchives.gov.uk/PRONOM/fmt/62</link>
					<tag>PRONOM entry for fmt/62</tag>
					<comment>Information in PRONOM on Microsoft Excel 2000-2003 Workbook (version 8X).  PUID: fmt/62</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://www.wikidata.org/wiki/Q28858068</link>
					<tag>Wikidata entry for Q28858068</tag>
					<comment>Information in Wikidata on Binary Interchange File Format, version 8.  WikiData Title ID: Q28858068</comment>
				</fdd:urlReference>
			</fdd:url>
			<fdd:url>
				<fdd:urlReference>
					<link>https://www.archives.gov/files/lod/dpframework/id/NF00263.ttl</link>
					<tag>NARA Preservation Plan ID entry for NF00263</tag>
				</fdd:urlReference>
			</fdd:url>
		</fdd:urls>
	</fdd:usefulReferences>
</fdd:FDD>
